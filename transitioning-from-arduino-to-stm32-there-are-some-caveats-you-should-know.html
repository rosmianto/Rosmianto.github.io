<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Transitioning from Arduino to STM32? There Are Some Caveats You Should Know - Captain Embedded üë®üèª‚Äç‚úàÔ∏è‚öì</title><meta name="description" content="You've learned Arduino and feel confident with your basic embedded skills. Now you want to upgrade yourself by learning STM32."><meta name="generator" content="Publii Open-Source CMS for Static Site"><script defer="defer" type="text/javascript" data-domain="rosmianto.com" src="https://view.rosmianto.com/js/script.outbound-links.tagged-events.js"></script><script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script><link rel="stylesheet" href="https://rosmianto.com/media/plugins/syntaxHighlighter/prism-gray.css"><link rel="stylesheet" href="https://rosmianto.com/media/plugins/syntaxHighlighter/prism-inline-color.css"><link rel="canonical" href="https://rosmianto.com/transitioning-from-arduino-to-stm32-there-are-some-caveats-you-should-know.html"><link rel="alternate" type="application/atom+xml" href="https://rosmianto.com/feed.xml"><link rel="alternate" type="application/json" href="https://rosmianto.com/feed.json"><meta property="og:title" content="Transitioning from Arduino to STM32? There Are Some Caveats You Should Know"><meta property="og:image" content="https://rosmianto.com/media/posts/23/8olf2u-2.jpg"><meta property="og:image:width" content="805"><meta property="og:image:height" content="500"><meta property="og:site_name" content="Captain Embedded üë®üèª‚Äç‚úàÔ∏è‚öì"><meta property="og:description" content="You've learned Arduino and feel confident with your basic embedded skills. Now you want to upgrade yourself by learning STM32."><meta property="og:url" content="https://rosmianto.com/transitioning-from-arduino-to-stm32-there-are-some-caveats-you-should-know.html"><meta property="og:type" content="article"><link rel="stylesheet" href="https://rosmianto.com/assets/css/style.css?v=7aa8cd9652c0014cd6c5dae831db723f"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://rosmianto.com/transitioning-from-arduino-to-stm32-there-are-some-caveats-you-should-know.html"},"headline":"Transitioning from Arduino to STM32? There Are Some Caveats You Should Know","datePublished":"2024-05-01T09:40+07:00","dateModified":"2024-05-02T12:11+07:00","image":{"@type":"ImageObject","url":"https://rosmianto.com/media/posts/23/8olf2u-2.jpg","height":500,"width":805},"description":"You've learned Arduino and feel confident with your basic embedded skills. Now you want to upgrade yourself by learning STM32.","author":{"@type":"Person","name":"Rosmianto A. Saputro","url":"https://rosmianto.com/authors/rosmianto-a-saputro/"},"publisher":{"@type":"Organization","name":"Rosmianto A. Saputro"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="lines"><div class="container lines lines--right"><header class="header"><a href="https://rosmianto.com/" class="logo">Captain Embedded üë®üèª‚Äç‚úàÔ∏è‚öì</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu">Menu</button><ul class="navbar__menu"><li><a href="https://rosmianto.com/authors/rosmianto-a-saputro/" target="_self">Articles</a></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Products (NEW üî•)</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://fwguide.rosmianto.com" target="_blank">Firmware Development Guide</a></li></ul></li><li><a href="https://newsletter.rosmianto.com" target="_blank">Newsletter</a></li><li><a href="https://www.linkedin.com/in/rosmianto/" target="_blank">LinkedIn</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__inner post__header"><h1 class="post__title">Transitioning from Arduino to STM32? There Are Some Caveats You Should Know</h1><div class="post__meta"><div class="post__meta__left"><a href="https://rosmianto.com/authors/rosmianto-a-saputro/" class="invert post__author" rel="author" title="Rosmianto A. Saputro"><img src="https://rosmianto.com/media/website/Untitled-Diagram.jpg" loading="eager" height="1700" width="1700" alt="Rosmianto A. Saputro"> Rosmianto A. Saputro</a></div><div class="post__meta__right"><time datetime="2024-05-01T09:40" class="post__date">May 1, 2024</time><div class="post__updated">Updated on <time datetime="2024-05-01T09:40" class="post__date">May 2, 2024</time></div></div></div></header><figure class="post__featured-image"><div class="post__featured-image__inner is-img-loading"><img src="https://rosmianto.com/media/posts/23/8olf2u-2.jpg" srcset="https://rosmianto.com/media/posts/23/responsive/8olf2u-2-xs.jpg 384w, https://rosmianto.com/media/posts/23/responsive/8olf2u-2-sm.jpg 600w, https://rosmianto.com/media/posts/23/responsive/8olf2u-2-md.jpg 768w, https://rosmianto.com/media/posts/23/responsive/8olf2u-2-lg.jpg 1200w, https://rosmianto.com/media/posts/23/responsive/8olf2u-2-xl.jpg 1600w" sizes="(min-width: 37.5em) 1600px, 80vw" loading="eager" height="500" width="805" alt=""></div></figure><div class="post__inner"><div class="post__entry"><p>You've learned Arduino and feel confident with your basic embedded skills. Now you want to upgrade yourself by learning STM32. It should be the next logical step, right?</p><p>First of all, I want to say congratulations to you because you've proved yourself that you enjoy embedded systems. Not many people can go through that phase.</p><p>Now, this is the new phase. Learning something more "serious" like STM32. (though you can seriously use Arduino as well, <a href="https://rosmianto.com/yes-you-can-use-arduino-for-commercial-grade-only-if-you-do-this.html" target="_blank" rel="noopener noreferrer">with some tips</a>).</p><p>I promise you, learning STM32 will be a delightful experience, and you won't regret a single bit (pardon the pun). But to ensure the smoothest transition, I will offer you some of my wisdom.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://rosmianto.com/media/posts/23//8olf2u.jpg" alt="" width="521" height="323" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://rosmianto.com/media/posts/23//responsive/8olf2u-xs.jpg 384w, https://rosmianto.com/media/posts/23//responsive/8olf2u-sm.jpg 600w, https://rosmianto.com/media/posts/23//responsive/8olf2u-md.jpg 768w, https://rosmianto.com/media/posts/23//responsive/8olf2u-lg.jpg 1200w, https://rosmianto.com/media/posts/23//responsive/8olf2u-xl.jpg 1600w"><figcaption>If you watched Avatar Aang, please read my tips using Roku's voice.</figcaption></figure><p>There are several things you need to know to ensure a smooth transition (not as smooth as butter though, you still have to learn a lot):</p><div class="post__toc"><h3>¬†</h3><ul><li><a href="#mcetoc_1hsp0ir5s46">Which STM32 board should you choose?</a></li><li><a href="#mcetoc_1hsp0ir5s47">To maximize learning, don't use Arduino framework</a></li><li><a href="#mcetoc_1hsp0ir5s48">CMSIS, HAL, mbed, Keil, IAR, CubeMX. What the hell are they?</a></li><li><a href="#mcetoc_1hsp0ir5s49">Different way to configure peripherals</a></li><li><a href="#mcetoc_1hsp0ir5s4a">Different build system (and flags)</a></li><li><a href="#mcetoc_1hsp0ir5s4b">Different library structure</a></li><li><a href="#mcetoc_1hsp0ir5s4c">More debugging feature</a></li></ul></div><p>¬†</p><p>Let's dive into each point.</p><h1 id="mcetoc_1hsp0ir5s46">Which STM32 board should you choose?</h1><p>If you just want to pick one board. Choose the blue pill. That's it. It's good enough for you to get started. Blue pill means the STM32 board's form-factor is like a giant pill and the color is blue.</p><p>Usually blue pills contain <strong>STM32F103</strong> microcontroller which is pretty good for various basic projects.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://rosmianto.com/media/posts/23/STM32F103C8T6_Blue_Pill-4-2.jpg" alt="" width="539" height="359" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://rosmianto.com/media/posts/23/responsive/STM32F103C8T6_Blue_Pill-4-2-xs.jpg 384w, https://rosmianto.com/media/posts/23/responsive/STM32F103C8T6_Blue_Pill-4-2-sm.jpg 600w, https://rosmianto.com/media/posts/23/responsive/STM32F103C8T6_Blue_Pill-4-2-md.jpg 768w, https://rosmianto.com/media/posts/23/responsive/STM32F103C8T6_Blue_Pill-4-2-lg.jpg 1200w, https://rosmianto.com/media/posts/23/responsive/STM32F103C8T6_Blue_Pill-4-2-xl.jpg 1600w"><figcaption>The Blue Pill with STM32F103 microcontroller. Image: stm32-base.org</figcaption></figure><p>Of course you can pick other boards. For example, if you want to focus on low-power project (aka battery-powered), you can explore STM32L series. Personally I'd go with L0 series (e.g. <strong>STM32L072</strong>) if I want to squeeze battery life, but with the cons being slower and not suitable for high-computing projects.</p><p>If I need more performance, I'd go with the L4 series (e.g. <strong>STM32L476</strong>). It has Floating-Point Unit (FPU) and larger memory. Great for projects like smartwatch. I have a project where I need to perform 1000 float/double calculations per second on the fly. L0 won't cut it. L4 series will crush this requirement.</p><p>You probably won't need more powerful boards right now. But if you do need some inspiration, you could use H5 or H7 series if you're doing crazy stuff like high-speed DSP, or AI/ML stuff.</p><p>But again, if you're just starting out the Blue Pill will do just fine.</p><h1 id="mcetoc_1hsp0ir5s47">To maximize learning, don't use Arduino framework</h1><p>Yes, you read that right. Though I have no issue if you use Arduino framework professionally, I think you should ditch Arduino framework this time.</p><blockquote><p>Wait, you could use Arduino framework with Blue Pill?</p><p>Yes. Search "STM32duino".</p></blockquote><p>Because you have used Arduino board like UNO or Pro or Micro before, you definitely have used Arduino framework (you know, if you used <code>Serial.begin(115200)</code> before, it's Arduino framework).</p><p>STM32 microcontroller is way too powerful compared to basic ATMega328 chip.</p><p>Arduino, in your case, will hinder your learning progress and will hide too many interesting features an STM32 microcontroller has to offer.</p><h1 id="mcetoc_1hsp0ir5s48">CMSIS, HAL, mbed, Keil, IAR, CubeMX. What the hell are they?</h1><p>They are tools and libraries in STM32 ecosystem.</p><p>ARM (the company) created ARM Cortex-M (the processor) and wrote libraries for it and call it <strong>CMSIS</strong>.</p><p>ST Microelectronics created microcontrollers (like STM32F103) and used Cortex-M as the processor. ST then wrote libraries for STM32F103 and called it <strong>HAL</strong> (on top of the CMSIS).</p><p><strong>mbed</strong> is ARM (the company) version of Arduino framework, it's far more powerful than Arduino. You probably want to get experience on HAL first, then if you're interested, you could try mbed.</p><p>Now, your firmware source code needs to be compiled so you can get the binary and flash it into the microcontroller. There are many options you can take:</p><ul><li>GCC Compiler. Free, but not too optimized for STM32 microcontroller.</li><li>IAR Compiler. Optimized binary result, but paid or limited feature in free version.</li><li>Keil Compiler. Also optimized and limited feature in free version.</li></ul><p>Pick GCC, it should enough for now. As you gain more experience and knowledge, you probably want to switch to IAR or Keil offering.</p><p>ST Microelectronics offers a tool called <strong>STM32CubeMX</strong> to generate a boilerplate (template project for you to get started).</p><p>Why would you need a boilerplate? Because STM32 microcontrollers have tons of peripherals, and each of them has tons of configuration. It's tedious and painful to write code manually over and over again, so ST created a tool to assist you generating the basic code.</p><h1 id="mcetoc_1hsp0ir5s49">Different way to configure peripherals</h1><p>I'd say it again, STM32 microcontrollers have tons of peripherals, and each of them has tons of configuration. Let me give you an example:</p><p>In STM32, you will find something called <strong>Clock Tree</strong>.</p><p>Unlike your classic ATMega328 which uses a single clock for the entire chip, STM32 can have different clock speeds for each of its peripherals. Why you might ask? In summary it's for flexibility.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://rosmianto.com/media/posts/23/Screenshot-2024-05-02-at-08.32.18.png" alt="" width="651" height="294" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://rosmianto.com/media/posts/23/responsive/Screenshot-2024-05-02-at-08.32.18-xs.png 384w, https://rosmianto.com/media/posts/23/responsive/Screenshot-2024-05-02-at-08.32.18-sm.png 600w, https://rosmianto.com/media/posts/23/responsive/Screenshot-2024-05-02-at-08.32.18-md.png 768w, https://rosmianto.com/media/posts/23/responsive/Screenshot-2024-05-02-at-08.32.18-lg.png 1200w, https://rosmianto.com/media/posts/23/responsive/Screenshot-2024-05-02-at-08.32.18-xl.png 1600w"><figcaption>The Clock Tree. STM32 even have 2 crystals with different frequencies (left blue boxes).</figcaption></figure><p>Now, configuring clock tree is error-prone when it's done manually, that's why we use CubeMX to help us generate correct settings for the entire system.</p><p>This is drastically different in Arduino, where we simply use <code>Serial.begin()</code> for UART peripheral, <code>SPI.begin()</code> for the SPI, and so on. Because the configuration is simple, we can do it in a single line. No need to have CubeMX for Arduino.</p><p>This is something you need to be aware of when exploring STM32. You will need CubeMX almost all the time.</p><p>I said this so you won't be surprised with the tooling.</p><h1 id="mcetoc_1hsp0ir5s4a">Different build system (and flags)</h1><p>In Arduino, usually we just click a button to compile the source code and flash binary to the board. We don't really care about the process. What we expect is to just get the board flashed.</p><p>Although we can automate the build process in STM32, we will have to make effort to understand the build system. For example, you need to understand linker script, CMake script, what files to compile, etc.</p><p>In Arduino you can't set the compile and linking flags. Heck, we don't even understand what is compiler "flags". Yes, it's an important topic but Arduino hides them from us.</p><p>Actually this topic alone is worth a book chapter, and I won't go deeper here. I'm just giving you a caution so you won't discouraged when things are getting harder (because it will be harder).</p><h1 id="mcetoc_1hsp0ir5s4b">Different library structure</h1><p>This is probably the most difficult thing to accept as someone transitioning from Arduino to STM32.</p><p>Arduino libraries have their own structure and way of operating. And they are, in general, not compatible with STM32 ecosystem (except someone has ported the libs).</p><p>For example, <a href="https://github.com/adafruit/Adafruit_SSD1306" target="_blank" rel="noopener noreferrer">this OLED display library</a> cannot directly be used for STM32 HAL. You need to port it manually (which requires some skills).</p><p>Some libraries are platform-independent, this is the kind of library I love. Some examples are <a href="https://github.com/mikalhart/TinyGPSPlus" target="_blank" rel="noopener noreferrer">TinyGPS</a> (with minor modifications), <a href="https://github.com/bblanchon/ArduinoJson" target="_blank" rel="noopener noreferrer">ArduinoJSON</a>, and <a href="https://github.com/boschsensortec/BMI160_SensorAPI" target="_blank" rel="noopener noreferrer">Bosch BMI160 driver</a> (not beginner-friendly though). So I can use them pretty much without much changes to use for my STM32 HAL projects.</p><p>So embrace the fact you will find yourself writing (or porting) driver for anything not Arduino compatible.</p><h1 id="mcetoc_1hsp0ir5s4c">More debugging feature</h1><p>In STM32 you will get more advanced debugging options: JTAG, SWD, as well as the classic printf().</p><p>The cool thing about advanced debugging is you can gain much deeper information about the <strong><em>system state</em></strong>. It's just a fancy word to describe current memory condition. You can see every variable's content, what functions are being called, what caused crash, how much memory a task consumes, etc.</p><p>You cannot do that using Arduino.</p><p>But for every advanced technology, there is always an additional effort to understand and use it.</p><p>So, make the effort and learn them.</p><p>There you have it. Happy learning STM32!</p><p>¬†</p><p class="msg msg--info" data-slate-node="element">Whenever you're ready, there are 2 ways I can help you:<br><br>1. <a href="https://freelancer.rosmianto.com/">Becoming Embedded Freelancer Book</a>. Learn how to earn more money (even more than your main job) working on freelance projects using a proven path explained from an embedded engineer's point-of-view.<br><br>2. <a href="https://fwguide.rosmianto.com/">Firmware Development Workflow Guide</a>. Upgrade your workflow to achieve efficient development, consistent code quality, robust firmware, and skyrocketed your productivity as an embedded engineer.</p></div><footer class="post__footer"><div class="post__tag-share"><div class="post__tag"><h3 class="post__tag__title">Posted in</h3><ul class="post__tag__list"><li><a href="https://rosmianto.com/tags/embedded-productivity/">Embedded Productivity</a></li></ul></div><div class="post__share"></div></div></footer></div></article><div class="post__related"><h3 class="post__related__title">Related posts</h3><div class="l-grid l-grid--2"><article class="c-card"><div class="c-card__wrapper"><figure class="c-card__image is-img-loading"><img src="https://rosmianto.com/media/posts/21/Screenshot-2024-04-06-at-20.49.23-2.png" srcset="https://rosmianto.com/media/posts/21/responsive/Screenshot-2024-04-06-at-20.49.23-2-xs.png 384w, https://rosmianto.com/media/posts/21/responsive/Screenshot-2024-04-06-at-20.49.23-2-sm.png 600w, https://rosmianto.com/media/posts/21/responsive/Screenshot-2024-04-06-at-20.49.23-2-md.png 768w, https://rosmianto.com/media/posts/21/responsive/Screenshot-2024-04-06-at-20.49.23-2-lg.png 1200w" sizes="(min-width: 37.5em) 80vw, 50vw" loading="lazy" height="956" width="1644" alt=""></figure><div class="c-card__content"><header><h2 class="c-card__title"><a href="https://rosmianto.com/6-real-world-embedded-projects-to-learn-from-warning-not-for-beginners.html" class="invert">6 Real-World Embedded Projects to Learn From (Warning! Not For Beginners)</a></h2></header><footer class="c-card__meta"><a href="https://rosmianto.com/tags/embedded-tips/" class="c-card__tag">Embedded Tips</a></footer></div></div></article><article class="c-card"><div class="c-card__wrapper"><div class="c-card__content"><header><h2 class="c-card__title"><a href="https://rosmianto.com/yes-you-can-use-arduino-for-commercial-grade-only-if-you-do-this.html" class="invert">Yes, You Can Use Arduino for Commercial-grade, Only If You Do This</a></h2></header><footer class="c-card__meta"><a href="https://rosmianto.com/tags/embedded-productivity/" class="c-card__tag">Embedded Productivity</a></footer></div></div></article></div></div></main><footer class="footer"><div class="footer__left"><div class="footer__copy">Powered by Publii</div></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://rosmianto.com/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script defer="defer" src="https://rosmianto.com/assets/js/scripts.min.js?v=6450cfc483efd7e58ed8ad5b64050d3e"></script><script>function publiiDetectLoadedImages () {
         var images = document.querySelectorAll('img[loading]:not(.is-loaded)');
         for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
               images[i].classList.add('is-loaded');
               images[i].parentNode.classList.remove('is-img-loading');
            } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
                  this.parentNode.classList.remove('is-img-loading');
               }, false);
            }
         }
      }
      publiiDetectLoadedImages();</script><script defer="defer" src="https://rosmianto.com/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://rosmianto.com/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://rosmianto.com/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://rosmianto.com/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><script defer="defer" src="https://rosmianto.com/media/plugins/syntaxHighlighter/prism-inline-color.min.js"></script></body></html>